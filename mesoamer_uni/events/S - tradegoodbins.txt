namespace = bins 

#This event produces a bin for every province depending on its trade good
#It's also a really janky version of a monthly pulse.
country_event = {
	id = bins.01

	title = "bins1.t"
	desc = "bins1.d"
	picture = ECONOMY_eventPicture

	is_triggered_only = yes
	
	immediate = {
		#Remove Warleader flag
		every_country = {
			limit = {
				AND = {
					is_at_war = no
					has_country_modifier = warleader
				}
			}
			remove_country_modifier = warleader
		}
		
		AZC = {
			country_event = { id = bins.01 days = 30 }
		}
		
		every_country = {
			country_event = { id = rrisk.01 days = 30 }
		}
		
		if = { 
			limit = { 
				NOT = { is_year = 1429 }
				TEN = {
					NOT = { has_country_modifier = bincooldown }
				}
			}
			TEN = {
				country_event = { id = countrystats.01 days = 334 }
				country_event = { id = populations.01 days = 334 }
				country_event = { id = populations2.01 days = 334 }
				country_event = { id = calctai.01 days = 334 }
				add_country_modifier = { 
					name = bincooldown
					duration = 334
				}
			}
		}
		if = {
			limit = {
				is_year = 1429
				TEN = {
					NOT = { has_country_modifier = bincooldown }
				}
			}
			TEN = {
				country_event = { id = countrystats.01 days = 365 }
				country_event = { id = populations.01 days = 365 }
				country_event = { id = populations2.01 days = 365 }
				country_event = { id = calctai.01 days = 365 }
				add_country_modifier = { 
					name = bincooldown
					duration = 365
				}
			}
		}
	
		TEN = {
			country_event = { id = admini.02 days = 30 }
		}
	}

	option = {
		name = "bins1.a"
		
		hidden_effect = {
		every_province = {
			controller = {
				random_list = {
					60 = {
						change_variable = { which = militarysupplies value = 1 }
					}
					40 = {
						#Nothing Produced
					}
				}
				random_list = {
					60 = {
						change_variable = { which = buildingsupplies value = 1 }
					}
					40 = {
						#Nothing Produced
					}
				}
				random_list = {
					75 = {
						change_variable = { which = staplefooditems value = 1 }
					}
					25 = {
						#Nothing Produced
					}
				}
				random_list = {
					50 = {
						change_variable = { which = luxuryfooditems value = 1 }
					}
					50 = {
						#Nothing Produced
					}
				}
				random_list = {
					40 = {
						change_variable = { which = luxurygoods value = 1 }
					}
					60 = {
						#Nothing Produced
					}
				}
			}
			if = {
				limit = {
					NOT = { has_province_modifier = devestated_by_war }
					NOT = { has_province_modifier = annihilated_by_war }
					OR = {
						trade_goods = grain
						trade_goods = aquaticfoods
					}
				}
				controller = {
					change_variable = { which = staplefooditems value = 1 }
				}
			}
			if = {
				limit = {
					NOT = { has_province_modifier = devestated_by_war }
					NOT = { has_province_modifier = annihilated_by_war }
					OR = {
						trade_goods = fruits
						trade_goods = choclate
						trade_goods = salt
					}
				}
				controller = {
					change_variable = { which = luxuryfooditems value = 1 }
				}
			}
			if = {
				limit = {
					NOT = { has_province_modifier = devestated_by_war }
					NOT = { has_province_modifier = annihilated_by_war }
					OR = {
						trade_goods = textiles
						trade_goods = preciousstones
						trade_goods = plumes
						trade_goods = bronze
						trade_goods = gold
					}
				}
				controller = {
					change_variable = { which = luxurygoods value = 1 }
				}
			}
			if = {
				limit = {
					NOT = { has_province_modifier = devestated_by_war }
					NOT = { has_province_modifier = annihilated_by_war }
					OR = {
						trade_goods = obsidian
					}
				}
				controller = {
					change_variable = { which = militarysupplies value = 2 }
				}
			}
			if = {
				limit = {
					NOT = { has_province_modifier = devestated_by_war }
					NOT = { has_province_modifier = annihilated_by_war }
					OR = {
						trade_goods = lime
						trade_goods = lumber 
					}
				}
				controller = {
					change_variable = { which = buildingsupplies value = 2 }
				}
			}
		}
		}
	}
}