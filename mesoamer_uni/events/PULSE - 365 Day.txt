namespace = yearpulse

country_event = {
	id = yearpulse.01

	title = "yearpulse1.t"
	desc = "yearpulse1.d"
	picture = ECONOMY_eventPicture

	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
		if = { 
			limit = { 
				MGI = {
					has_country_modifier = manpowercalcwait
				}
			}
			
			#Yearly Gameplay Events
			MGI = {
				#country_event = { id = populations.01 }#Update population once a year
				#country_event = { id = countrystats.01 }#Update country stats once a year
				#country_event = { id = calctai.01 }#Update triple alliance influence
				#country_event = { id = estatefavors.01 }#Update Estate Favors 
				#country_event = { id = yearpulse.01 days = 334 }#Rerun this event 
			}
			
			#Collect Tribute
			every_country = {
				limit = {
					OR = {
						government = altepetl
						government = tlaxcallan_confederate 
					}
					num_of_cities = 2
				}
				#country_event = { id = tributecoll.02 days = 334 }
			}
			
			#Payments from Estates
			every_country = {
				#country_event = { id = commeff.01}
				if = {
					limit = {
						OR = {
							has_country_modifier = ms_war_contribution_1
							has_country_modifier = ms_war_contribution_2
							has_country_modifier = ms_war_contribution_3
						}
						is_at_war = no
					}
					remove_country_modifier = ms_war_contribution_1
					remove_country_modifier = ms_war_contribution_2
					remove_country_modifier = ms_war_contribution_3
				}
				if = { 
					limit = {
						OR = { 
							has_country_modifier = ms_war_contribution_1
							has_country_modifier = ms_war_contribution_2
							has_country_modifier = ms_war_contribution_3
						}
					}
					country_event = { id = requestsupport.12 }
				}
			}
		}
		
		
		if = {
			limit = {
				MGI = {
					NOT = { has_country_modifier = manpowercalcwait }
				}
			}
			MGI = {
				#country_event = { id = populations.01 }
				#country_event = { id = countrystats.01 }
				#country_event = { id = calctai.01 }
				#country_event = { id = estatefavors.01 }
				#country_event = { id = yearpulse.01 days = 365}	
			}
			
			every_country = {
				limit = {
					OR = {
						government = altepetl
						government = tlaxcallan_confederate 
					}
					num_of_cities = 2
				}
				#country_event = { id = tributecoll.02 days = 365 }
			}
			
			every_country = {
				#country_event = { id = commeff.01}
				if = {
					limit = {
						OR = {
							has_country_modifier = ms_war_contribution_1
							has_country_modifier = ms_war_contribution_2
							has_country_modifier = ms_war_contribution_3
						}
						is_at_war = no
					}
					remove_country_modifier = ms_war_contribution_1
					remove_country_modifier = ms_war_contribution_2
					remove_country_modifier = ms_war_contribution_3
				}
				if = { 
					limit = {
						OR = { 
							has_country_modifier = ms_war_contribution_1
							has_country_modifier = ms_war_contribution_2
							has_country_modifier = ms_war_contribution_3
						}
					}
					country_event = { id = requestsupport.12 }
				}
			}
		}
		}
	}
	
	option = {
		name = "yearpulse1.a"
	}
}