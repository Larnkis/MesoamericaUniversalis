namespace = rrisk 

#Handles updating of revolt risk once a month
country_event = {
	id = rrisk.01

	title = "rrisk1.t"
	desc = "rrisk1.d"
	picture = ECONOMY_eventPicture

	is_triggered_only = yes
	
	hidden = yes
	
	option = {
		name = "rrisk1.a"
		ROOT = { 
		every_subject_country = {
			limit = {
				always = yes
			}
			overlord = {
				subtract_variable = { which = subjectrevoltrisk which = subjectrevoltrisk }
			}
			#MITIGATING FACTORS
			#From Ideas
			if = {
				limit = {
					overlord = {
						has_idea = showsofstrength 
					}
				}
				add_liberty_desire = -0.50
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.50 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						has_idea = tribtrade
					}
				}
				add_liberty_desire = -0.25
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.25 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						has_idea = expanddip2
					}
				}
				add_liberty_desire = -0.25
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.25 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						has_idea = tributeministers
					}
				}
				add_liberty_desire = -0.25
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.25 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						has_idea = unchallengable
					}
				}
				add_liberty_desire = -1
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -1 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						AND = {
							has_idea = gloriousleader
							legitimacy = 95
						}
					}
				}
				add_liberty_desire = -2
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -2 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						has_idea = subjectspy
					}
				}
				add_liberty_desire = -1
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -1 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						has_idea = threatofaction
					}
				}
				add_liberty_desire = -1
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -1 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						has_idea = multicultural_states
					}
				}
				add_liberty_desire = -0.50
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.50 }
				}
			}
			
			#From Prestige
			if = {
				limit = {
					overlord = {
						AND = {
							prestige = 0
							NOT = { prestige = 5 }
						}
					}
				}
				add_liberty_desire = -0.10
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.10 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						AND = {
							prestige = 5
							NOT = { prestige = 10 }
						}
					}
				}
				add_liberty_desire = -0.20
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.20 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						AND = {
							prestige = 10
							NOT = { prestige = 20 }
						}
					}
				}
				add_liberty_desire = -0.30
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.30 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						AND = {
							prestige = 20
							NOT = { prestige = 30 }
						}	
					}
				}
				add_liberty_desire = -0.40
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.40 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						AND = {
							prestige = 30
							NOT = { prestige = 40 }
						}
					}
				}
				add_liberty_desire = -0.50
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.50 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						AND = {
							prestige = 40
							NOT = { prestige = 50 }
						}
					}
				}
				add_liberty_desire = -0.60
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.60 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						AND = {
							prestige = 50
							NOT = { prestige = 60 }
						}
					}
				}
				add_liberty_desire = -0.70
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.70 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						AND = {
							prestige = 60
							NOT = { prestige = 70 }
						}
					}
				}
				add_liberty_desire = -0.80
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.80 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						AND = {
							prestige = 70
							NOT = { prestige = 80 }
						}
					}
				}
				add_liberty_desire = -0.90
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.90 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						AND = {
							prestige = 80
							NOT = { prestige = 90 }
						}
					}
				}
				add_liberty_desire = -1
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -1 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						prestige = 90
					}
				}
				add_liberty_desire = -1.5
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -1.5 }
				}
			}
			
			#From Tribute Requirements
			if = {
				limit = {
					overlord = {
						has_country_modifier = lowwarriors
					}
				}
				add_liberty_desire = -1
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.50 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						has_country_modifier = lowsupplies
					}
				}
				add_liberty_desire = -1
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.50 }
				}
			}
			
			#From Legitimacy
			if = {
				limit = {
					overlord = {
						legitimacy = 90
					}
				}
				add_liberty_desire = -0.20
				overlord = {
					change_variable = { which = subjectrevoltrisk value = -0.20 }
				}	
			}
			
			#AGGRAVATING FACTORS
			#From Ideas
			if = {
				limit = {
					overlord = {
						AND = {
							has_idea = gloriousleader
							NOT = { legitimacy = 70 }
						}
					}
				}
				add_liberty_desire = 4
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 4 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						has_idea = nicepolicy
					}
				}
				add_liberty_desire = 1
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 1 }
				}
			}
			
			#From Army Size
			if = {
				limit = {
					overlord = {
						NOT = { army_size = 4 }
					}
				}
				add_liberty_desire = 5
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 5 }
				}
			}
			
			#From Tribute Requirements
			if = {
				limit = {
					overlord = {
						has_country_modifier = highwarriors
					}
				}
				add_liberty_desire = 2
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 2 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						has_country_modifier = highsupplies
					}
				}
				add_liberty_desire = 2
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 2 }
				}
			}
			
			#From Legitimacy 
			if = {
				limit = {
					overlord = {
						legitimacy = 80
						NOT = { legitimacy = 90 }
					}
				}
				add_liberty_desire = 1
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 1 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						legitimacy = 70
						NOT = { legitimacy = 80 }
					}
				}
				add_liberty_desire = 2
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 2 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						legitimacy = 60
						NOT = { legitimacy = 70 }
					}
				}
				add_liberty_desire = 3
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 3 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						legitimacy = 40
						NOT = { legitimacy = 60 }
					}
				}
				add_liberty_desire = 4
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 4 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						legitimacy = 20
						NOT = { legitimacy = 40 }
					}
				}
				add_liberty_desire = 5
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 5 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						legitimacy = 0 
						NOT = { legitimacy = 20 }
					}
				}
				add_liberty_desire = 6
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 6 }
				}
			}
			
			#From Overlord Stability
			if = {
				limit = {
					overlord = {
						NOT = { stability = 0 }
					}
				}
				add_liberty_desire = 2
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 4 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						NOT = { stability = -1 }
					}
				}
				add_liberty_desire = 2
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 2 }
				}
			}
			
			if = {
				limit = {
					overlord = {
						NOT = { stability = -2 }
					}
				}
				add_liberty_desire = 2
				overlord = {
					change_variable = { which = subjectrevoltrisk value = 2 }
				}
			}
			
			#From Overlord vs Subject Culture 
			#Not sure how to implement this yet!
		}
		change_variable = { which = subjectrevoltrisk which = warsandbattlesrrisk }
		subtract_variable = { which = warsandbattlesrrisk which = warsandbattlesrrisk }
	}
	}
}

#Displays monthly revolt risk change to the player
country_event = {
	id = rrisk.02

	title = "rrisk2.t"
	desc = "rrisk2.d"
	picture = ECONOMY_eventPicture

	is_triggered_only = yes
	
	option = {
		name = "rrisk2.a"
		clr_country_flag = drrdisplaying
	}
}

